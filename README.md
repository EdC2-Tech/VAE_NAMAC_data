# VAE_NAMAC_data

## Description
This program generates training data using a variational autoencoder to train machine learning models. The intention of this dataset is to help users generate training data for machine learning models in semi-realistic nuclear reactor transient conditions. The type of transient observed is a loss-of-flow transient. An example of the usage of the data can be found in: 
<br />
<br />
E. Chen, L. Lin, N.T. Dinh, "Advaned Transient Diagnostic with Ensemble Digital Twin Modeling," https://arxiv.org/abs/2205.11469
<br />
<br />
The data generated is based off a GOTHIC simulation of the Experimental Breeder Reactor II. Experimental validation of the GOTHIC simulation is available at:
<br />
<br />
J.W. Lane, J.M Link, J.M. King, T.L. George, S.W. Claybrook, "Benchmark of GOTHIC to EBR-II SHRT-17 and SHRT 45R Tests," Nuclear Technology, https://doi.org/10.1080/00295450.2019.1698896
<br />
<br />
Three types of data are generated by the VAE; total core flow rate [kg/s], upper plenum temperature [C], and fuel centerline temperature [C]. The first and second parameter are the sensor measurements while the last parameter is the prediction target. 


## How to generate data
### Step 1:
It is recommended to use Anaconda to generate the necessary dependencies to run the file. The environment information to generate the necessary dependencies is provided in the "environment.yml" file.
Ensure that you setup the environment using the .yml file so that the program can work properly.

### Step 2:
Open "DataGen.py" and look for the variable "num_transients". This variable specifies the number of transients to generate using the VAE. By default 10 samples are generated each containing 2000 time steps. Change this number to fit your requirements.

### Step 3:
The generated data is located in the folder "Generated_Data". Details about each column is provided in the file "Column Information.txt"

### Step 4 (Optional):
Use the data to construct your own machine learning model. The input features are the total core flow rate and the upper plenum temperature. The target is the fuel centerline temperature. Time is not a feature and is only used for plotting.

### Citing this work
If you use this respository, please cite:
<br />
<br />
E. Chen, H. Bao, N.T Dinh, "Evaluating the Reliability of Machine-Learning-based Prediction used in Nuclear Power Plant Instrumentation and Control Systems," Reliability Engineering & System Safety, 2024
<br />
<br />
## Repository Contents
**DataGen.py** - file to use to generate the training transient data.<br />
**environment.yml** - file to use to generate and configure Anaconda enviroment dependencies.<br />
**trainVAE.py** - NOT USED, file used to train the VAE model. Not available to users as training data for VAE is not available.<br />
**/Generated_Data** - folder where generated training data will be located. <br />
**lib** - DO NOT MODIFY, library folder containing python modules. <br />
**VAEModelSetting** - folder containing the VAE models. Two slightly different versions are provided but serve as backups. <br />
